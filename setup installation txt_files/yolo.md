YOLO 
you only look once

이미지 크기가 크면 작은 커널에서는 제대로 탐지를 못함
그래서 
이미지를 작게 만들어서 커널에 맞게 축소해서 찾는 방식
이미지 피라미드, 다양한 커널로 
커널 사이즈별로 이미지를 훑는데 컨볼루션을 하는데 시간이 오래걸리게 됨

분류의 문제는 
image classification
object localization - 위치에 박스를 친다

이 2개를 벡터로 표현함, 만든사람이 설계함
Pc - 이미지 안에 관심있는 물체가 있을 확률 (예: 개 or 사람이 있으면 1, 없으면 0)
Bx - 물체의 x좌표
By - 물체의 y좌표
Bw - 물체의 중심좌표로부터 width (사각형을 그리기 위해)
Bh - 물체의 중심좌표로부터 height (사각형을 그리기 위해)
C1 - 클래스1 (dog) - 개이면 1 아니면 0
C2 - 클래스2 (human) - 사람이면 1 아니면 0  #분류가 2개일 경우

| . | image classification / object localization |
| -- | -- |
| Pc | 이미지 안에 관심있는 물체가 있을 확률 (예: 개 or 사람이 있으면 1, 없으면 0) |
| Bx | 물체의 x좌표 |
| By | 물체의 y좌표 |
| Bw | 물체의 중심좌표로부터 width (사각형을 그리기 위해) |
| Bh | 물체의 중심좌표로부터 height (사각형을 그리기 위해) |
| C1 | 클래스1 (dog) - 개이면 1 아니면 0 |
| C1 | 클래스2 (human) - 사람이면 1 아니면 0  #분류가 2개일 경우 |

<br>


그래서 분류 문제였으면 마지막 output 값이 시그모이드로 1이 되었는데 

결과값이 7개로 늘어남
그래서 이 벡터 베이터가 y_train 정답지가 되어서 값을 일일이 다 셋팅해준 것임

그리고 CNN 학습 training
Convolutional Neural Network

문제점은 학습 결과가 개 아니면 사람의 결과인 C1 또는 C2가 1인 값이 포함된 벡터로만 나오게 되어서
사람이 여럿이 있고 개, 사람이 같이 있어도 (여러개의 오브젝트가 있어도)
결과는 하나의 벡터만 나오게 된다.. (학습을 그렇게 시켰기 때문에.. 결과는 당연하다)

그래서 
사진의 그리드를 나눠서 예를 들어서 16개로 나눈다면 (4x4)
각 영역에서의 결과도 16개가 나오게 되어서 결과는 한 그리드 셀당 7개의 벡터로 나오니
여러 물체를 탐지가 가능해짐

(4x4x7)이 된다
학습을 다시시켜서 예측값도 (4x4x7) 이 나오게 되어서 여러 물체를 탐지할 수 있다.

또 여기에서 문제는 같은 그리드 셀에 물체가 겹쳐 있으면
바운딩 박스 (물체 위에 그려지는 박스)가 여러개가 생기게 됨

그래서 pc값이 높은 값만 남겨두고 나머지는 지우는 방법을 사용
하지만 그렇게 되면 
만약 개와 사람이 같이 있다고 하면은, 사람의 pc값이 높다면은 개 사진이 지워지게 된다

그래서 IOU 값으로 높은 값을 계산해서 같은 물체로 여김
intersection over union = inersect area / union area
교집합(공통으로 겹치는 영역) / 합집합 (전체 겹치는 전체 영역)
IOU는 0~1까지 나오게 되고 (이것도 사람이 정할 수 있는 하이퍼 파라미터가 된다)

IOU: Intersection Over Union

IOU가 클 수록 같은 물체라는 뜻이된다

Non Max suppression


또 다른 문제느 하나의 그리드에 두 개의 오브젝트 중심이 있는 경우

이것을 해결하기 위해서 오브젝트의 결과값을 하나의 벡터로 처리
만약 한 셀에 2개의 물체가 겹쳐 있다면
하나의 셀에 2개의 벡터가 나와야하는데 하나의 벡터로 처리하는 방법이 있다
한 그리드 셀에 2개의 벡터를 하나로 합쳐서 14개 나오게 하는 것
Anchor Boxes 라고 한다


mAP가 YOLOv3가 높게 나옴
https://pjreddie.com/darknet/yolo/

<br>

# ssd
하나의 이미지를 한번에 처리하는 그리드 방식 (YOLO도 그리드 방식이지만.. 조금 다름)
CNN을 할 때 이미지를 여러개의 커널들로 컨볼루션을 하고 컨볼루션을 하면 이미지가 작아지고 커널(피쳐)의 갯수만큼 생긴다
맥스풀링을 하면 또 이미지가 작아진다. 거기에서 또 컨볼루션 또 작아짐---> 다시 맥스풀링 --> 또 작아짐->
플래튼을 하고 (하나로 만들고) 그 때마다 결과를 다 모음??;;;

Image Pyramid




