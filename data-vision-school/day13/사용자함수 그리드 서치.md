# Grid Search 그리드 서치
하이퍼파라미터를 지정해서 최적의 파라미터 값을 찾아준다.

## 패키지 불러오기
```py
from keras.wrappers.scikit_learn import KerasClassifier
from sklearn.model_selection import GridSearchCV
from keras.models import Sequential
from keras.layers import Dense
```

## 사용자 함수 만들기
모델링 빌드 순서  
1. Sequential() 객채 생성
2. add( Dense() )추가 - Input Layer 추가 `input_dim = 컬럼수`  
3. complie()

```py
def build_classifier(optimizer) :
    classifier = Sequential()
    classifier.add( Dense( input_dim = 11, units = 6, activation='relu') )
    classifier.add( Dense( units= 8, activation=tf.nn.relu) )
    classifier.add( Dense( units=1, activation=tf.nn.sigmoid) )
    classifier.compile(loss='binary_crossentropy', optimizer = optimizer , metrics=['accuracy'] )
    return classifier
```

## KerasClassifier 캐라스 클래스파이어 생성
```py
# build_fn= 파라미터
# 사용자 함수를 지정할 수 있음
classifier = KerasClassifier(build_fn = build_classifier)
```

파라미터를 딕셔너리 형태로 만들어 준다  
batch_size, epochs, optimizer의 value값은 리스트형태로 만듬
```py
param = {
    'batch_size' : [10, 20, 25],
    'epochs': [200, 500, 700],
    'optimizer': ['adam', 'rmsprop'] 
}
```

## GridSearchCV 그리드 서치 생성
```py
# scoring='accuray' 대개 정확도를 선택
# cv= 원래 있던 트렌인셋을 10개로 쪼개서 더 정교하게 학습을 시키는 것
# 부분 돌아가면서 학습을 함,
# cross validation
grid_search = GridSearchCV(estimator= classifier, param_grid=param, scoring='accuracy', cv=10)
```

