# CNN
## import
```py
import tensorflow as tf
from keras.datasets import mnist
from keras.models import Sequential
from keras.layers import Dense, Flatten
from keras.layers import Conv2D, MaxPooling2D
```

## 데이터 다운
```py
mnist = tf.keras.datasets.mnist
(training_images, training_labels), (test_images, test_labels) = mnist.load_data()
```

## 함수에 하나로 모음
```py
def train_mnist_conv():
    # myCallback class
  class myCallback(tf.keras.callbacks.Callback):
    def on_epoch_end(self, epoch, logs={}):
      i = 0.998
      if (logs.get('accuracy') > i ):
        print("\n정확도 {}%가 되어서 학습을 종료합니다".format(i*100))  
        self.model.stop_training = True
    
  myCallback = myCallback()
   
  mnist = tf.keras.datasets.mnist
  (training_images, training_labels), (test_images, test_labels) = mnist.load_data()

  training_images = training_images.reshape(60000 , 28, 28, 1)
  test_images = test_images.reshape(10000 , 28, 28, 1)
  
  training_images = training_images / 255.0
  test_images = test_images / 255.0

  model = tf.keras.models.Sequential([
    Conv2D( filters = 64, kernel_size=(3, 3), activation='relu', input_shape= (28, 28, 1) ),
    MaxPooling2D( 2, 2 ),
    Flatten(),
    Dense( units=256, activation='relu'),
    Dense( units=512, activation='relu'), 
    Dense( units=10, activation='softmax')
    
  ])

  model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy'])
    # model fitting
  history = model.fit(
    training_images, training_labels, epochs=20, validation_split=0.25, callbacks=[ myCallback ]
  )
  # model fitting
  return history.epoch, history.history['accuracy'][-1]
```

## 학습 
```py
hist_epoch, hist_accuracy = train_mnist_conv()
```
